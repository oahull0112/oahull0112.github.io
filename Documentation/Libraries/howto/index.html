
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../intro_libraries/">
      
      
        <link rel="next" href="../../Debugging/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.6">
    
    
      
        <title>Libraries How-to - OAH</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.50c56a3b.min.css">
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 21h8v-8h-2v4.59L6.41 5H11V3H3v8h2V6.41L17.59 19H13v2Z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#libraries-how-to-linking-scientific-libraries" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="OAH" class="md-header__button md-logo" aria-label="OAH" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OAH
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Libraries How-to
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../howto/" class="md-tabs__link">
        
  
    
  
  How-To

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../Applications/vasp/" class="md-tabs__link">
          
  
    
  
  Documentation

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="OAH" class="md-nav__button md-logo" aria-label="OAH" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    OAH
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../howto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How-To
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Applications
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Applications/vasp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VASP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Applications/applications_template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Combined Module/Build Template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Applications/berkeleygw_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BerkeleyGW Combined Module/Build Example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Applications/berkeleygw_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BerkeleyGW Module Example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Applications/berkeleygw_build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BerkeleyGW Build Example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Applications/applications_template_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application Module Template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Applications/applications_template_build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Application Build Template
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programming Languages
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Programming Languages
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ProgrammingLanguages/fortran/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fortran Example
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Libraries
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Libraries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro_libraries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Libraries How-to
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Libraries How-to
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#makefiles-autoconf-and-cmake" class="md-nav__link">
    <span class="md-ellipsis">
      Makefiles, autoconf, and cmake
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#walkthrough" class="md-nav__link">
    <span class="md-ellipsis">
      Walkthrough
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-with-mkl-and-hdf5" class="md-nav__link">
    <span class="md-ellipsis">
      Building with MKL and HDF5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Preparation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modifying-the-makefile-for-mkl" class="md-nav__link">
    <span class="md-ellipsis">
      Modifying the Makefile for MKL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modifying-the-makefile-for-hdf5" class="md-nav__link">
    <span class="md-ellipsis">
      Modifying the Makefile for HDF5
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#questions" class="md-nav__link">
    <span class="md-ellipsis">
      Questions?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro_libraries#mkl" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MKL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro_libraries#libsci" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LibSci
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro_libraries#fftw" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FFTW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro_libraries#lapack-and-scalapack" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LAPACK
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../intro_libraries#hdf5" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HDF5
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Debugging/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Debugging
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Debugging
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Debugging/ddt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DDT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Debugging/gdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GDB
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#makefiles-autoconf-and-cmake" class="md-nav__link">
    <span class="md-ellipsis">
      Makefiles, autoconf, and cmake
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#walkthrough" class="md-nav__link">
    <span class="md-ellipsis">
      Walkthrough
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-with-mkl-and-hdf5" class="md-nav__link">
    <span class="md-ellipsis">
      Building with MKL and HDF5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Environment Preparation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modifying-the-makefile-for-mkl" class="md-nav__link">
    <span class="md-ellipsis">
      Modifying the Makefile for MKL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modifying-the-makefile-for-hdf5" class="md-nav__link">
    <span class="md-ellipsis">
      Modifying the Makefile for HDF5
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-of-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Steps
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#questions" class="md-nav__link">
    <span class="md-ellipsis">
      Questions?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="libraries-how-to-linking-scientific-libraries">Libraries How-To: Linking Scientific Libraries<a class="headerlink" href="#libraries-how-to-linking-scientific-libraries" title="Permanent link">#</a></h1>
<p>debugging index test <a href="/Documentation/Debugging/index">here</a></p>
<p>debugging index sublink test <a href="/Documentation/Debugging/index/#key-parallel-debugging-features">here</a></p>
<p>fortran link test <a href="/Documentation/ProgrammingLanguages/fortran">here</a></p>
<p>fortran sublink test <a href="/Documentation/ProgrammingLanguages/fortran/#compilers">here</a></p>
<p>This page is a tutorial explaining how to include scientific libraries when compiling software. </p>
<p>There are a few common scientific libraries: LAPACK, BLAS, BLACS, scaLAPACK, fftw, hdf5, and others. These libraries are generally highly optimized, and many scientific programs favor use of these libraries over in-house implementations of similar functionality.  </p>
<p>Scientific libraries can be packaged together, like in the Intel Math Kernel Library (MKL), or Cray’s LibSci. They can also be built completely separately and act as standalone libraries. These libraries can be built with different MPI implementations and compiler choices. </p>
<p>If you’re building a code that relies on one or more of these libraries, you can choose how to include these libraries. By the end of this tutorial, how to include these libraries should be clearer. If you need help building a particular package on an NREL machine, please contact <a href="mailto:hpc-help@nrel.gov">HPC help</a>. </p>
<h2 id="makefiles-autoconf-and-cmake">Makefiles, autoconf, and cmake<a class="headerlink" href="#makefiles-autoconf-and-cmake" title="Permanent link">#</a></h2>
<p>Build tools like make, autoconf, and cmake are convenient ways to automate the compilation of a code. If you’re building a package, you may need to modify/customize how the code compiles, e.g., so it finds and includes the libraries you want. This may involve directly modifying the makefile, modifying the make.include (or make.inc, makefile.include, etc.) file, or using tools like autoconf or CMake to configure the makefile. </p>
<p>Modifying a makefile (or make.include, etc.) so it compiles using the scientific libraries you want can be a daunting process. We’ll go through a prototypical example and show how different libraries can be included in the build of a program. To do this, we’ll use a makefile.include file for the electronic structure program VASP.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We provide a walkthrough of linking scientific libraries using the VASP code as an example. This walkthrough tries to demonstrate key features of the general process of including scientific libraries in a build. We note that the exact build and modification process will vary between codes. Consulting the documentation of the code you’re trying to build is always the best place to start. </p>
</div>
<h2 id="walkthrough">Walkthrough<a class="headerlink" href="#walkthrough" title="Permanent link">#</a></h2>
<h3 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">#</a></h3>
<p>We’ll use the VASP makefile.include file as our walkthrough example. We can find a number of VASP makefile.include files <a href="https://www.vasp.at/wiki/index.php/Makefile.include">here</a>. We’ll be looking specifically at <a href="https://www.vasp.at/wiki/index.php/Makefile.include.intel_omp">this</a> file.</p>
<p>We’ll take a look at building with Intel MKL and the HDF5 package. </p>
<h3 id="building-with-mkl-and-hdf5">Building with MKL and HDF5<a class="headerlink" href="#building-with-mkl-and-hdf5" title="Permanent link">#</a></h3>
<p>We want to build with MKL and HDF5. If we look at the VASP documentation, we see that LAPACK, scaLAPACK, BLAS, and FFTW are required. MKL covers all of these needs. Thus, we need to tell the makefile where to look for MKL.</p>
<h3 id="environment-preparation">Environment Preparation<a class="headerlink" href="#environment-preparation" title="Permanent link">#</a></h3>
<p>We need our MKL to be built with the same compilers and MPI implementation as we’re building VASP with. Let’s see what sorts of MKL builds are available to us. Using the following command to show what builds of mkl are available as a module: </p>
<p><code>module avail 2&gt;&amp;1 | grep mkl</code> </p>
<p>Yields the output: </p>
<p><code>intel-oneapi-mkl/2023.0.0-intel      ucx/1.13.0</code> </p>
<p>Thus, if we want to use the toolchains managed by NREL, we must use the Intel oneapi toolchain in our VASP build, since <code>intel-oneapi-mkl/2023.0.0-intel</code> is the only available mkl module. If you want to use a different toolchain, you could build MKL yourself, but that’s outside the scope of this article. </p>
<p>To “use the Intel oneapi toolchain” means to use Intel compilers and Intel’s implementation of MPI to compile VASP. We’re doing this because mkl was built with this toolchain, and we want our toolchains to match as best as possible to minimize build errors and bugs. </p>
<p>Let’s prepare our environment to use this toolchain. First, </p>
<p><code>module purge</code> </p>
<p>To clear your environment. Now, we want the Intel oneapi mkl module, the Intel fortran compiler (ifort), and the Intel MPI fortran compiler (mpiifort). Type: </p>
<p><code>module avail 2&gt;&amp;1 | grep oneapi</code> </p>
<p>to see which modules are related to the intel-oneapi toolchain. We can locate the three we want: </p>
<div class="highlight"><pre><span></span><code>module load intel-oneapi-mkl/2023.0.0-intel 
module load intel-oneapi-mpi/2021.8.0-intel 
module load intel-oneapi/2022.1.0 
</code></pre></div>
<p>How do we know these are the ones we want? The first line loads the mkl module. The second line gives us mpiifort, the Intel MPI fortran compiler, and the third line gives us ifort, the Intel Fortran compiler. (test the latter two with <code>which mpiifort</code> and <code>which ifort</code> -- you’ll see that they’re now in your path. If you <code>module purge</code> and try <code>which mpiifort</code> again, you’ll see you’re not able to find mpiifort anymore.) </p>
<h3 id="modifying-the-makefile-for-mkl">Modifying the Makefile for MKL<a class="headerlink" href="#modifying-the-makefile-for-mkl" title="Permanent link">#</a></h3>
<p>Now that we have the toolchain loaded into our environment, let’s take a look at the actual makefile.include file (link to file <a href="https://www.vasp.at/wiki/index.php/Makefile.include.intel_omp">here</a>). There are two important sections for the purpose of getting the code to build. The first: </p>
<div class="highlight"><pre><span></span><code>CPP         = fpp -f_com=no -free -w0  $*$(FUFFIX) $*$(SUFFIX) $(CPP_OPTIONS) 
FC          = mpiifort -qopenmp 
FCL         = mpiifort 
</code></pre></div>
<p>The first line says that the compiler pre-processor will be fpp (try <code>which fpp</code> and you should get an output <code>/sfs/nopt/nrel/apps/compilers/01-23/spack/opt/spack/linux-rhel8-icelake/gcc-8.4.0/intel-oneapi-compilers-2022.1.0-wosfexnwo5ag3gyfoco2w6upcew5yj6f/compiler/2022.1.0/linux/bin/intel64/fpp</code>, confirming that we’re pulling fpp from intel-oneapi).  </p>
<p>The second and third lines say that we’ll be using Intel’s MPI (Try <code>which mpiifort</code> to confirm that it is in your path). FC is the “Fortran Compiler” and FCL is the corresponding linker. Line 14 additionally says we’ll be compiling with openmp. Different compilers have different executable names (e.g. mpiifort for Intel MPI fortran compiler, mpifort for GNU). See the <a href="/Documentation/ProgrammingLanguages/fortran">Fortran documentation page</a> for a complete list. </p>
<p>The next important section is given below: </p>
<div class="highlight"><pre><span></span><code># Intel MKL (FFTW, BLAS, LAPACK, and scaLAPACK) 
# (Note: for Intel Parallel Studio&#39;s MKL use -mkl instead of -qmkl) 
FCL        += -qmkl 
MKLROOT    ?= /path/to/your/mkl/installation 
LLIBS      += -L$(MKLROOT)/lib/intel64 -lmkl_scalapack_lp64 -lmkl_blacs_intelmpi_lp64
INCS        =-I$(MKLROOT)/include/fftw 
</code></pre></div>
<p>This makefile.include file has been provided to us by VASP. Our job here is two-fold:</p>
<ol>
<li>To ensure that we tell make (via the makefile.include file) the correct place to find MKL, I.e., to ensure that <code>MKLROOT</code> in the makefile.include file is set correctly.</li>
<li>To ensure that we tell make the correct libraries to reference within <code>MKLROOT</code>.</li>
</ol>
<p>To do step 1, first type:</p>
<p><code>module list</code> </p>
<p>To see the modules you’ve loaded into your environment. You should have <code>intel-oneapi-mkl/2023.0.0-intel</code> in the list.  If not, review the <a href="#environment-preparation">environment preparation</a> section. Now, we use the <code>module show</code> command to find the root directory of mkl: </p>
<p><code>module show intel-oneapi-mkl/2023.0.0-intel</code> </p>
<p>We see in the output of this command the following line: </p>
<p><code>setenv      MKLROOT /sfs/nopt/nrel/apps/libraries/01-23/spack/opt/spack/linux-rhel8-icelake/intel-2021.6.0/intel-oneapi-mkl-2023.0.0-gnkrgwyxskxitvptyoubqaxlhh2v2re2/mkl/2023.0.0</code> </p>
<p>If we type <code>echo $MKLROOT</code>, we can confirm that this environment variable is properly set from when we ran the command <code>module load intel-oneapi-mkl/2023.0.0-intel</code>. In the VASP makefile, we have <code>MKLROOT    ?= /path/to/your/mkl/installation</code>. The ?= means that this variable will not be set if <code>MKLROOT</code> has already been set. So, we can ignore this line if we’d like. However, to be safe, we should simply copy the path of the MKL root directory to this line in makefile.include, so that this line now reads: </p>
<p><code>MKLROOT    ?= /sfs/nopt/nrel/apps/libraries/01-23/spack/opt/spack/linux-rhel8-icelake/intel-2021.6.0/intel-oneapi-mkl-2023.0.0-gnkrgwyxskxitvptyoubqaxlhh2v2re2/mkl/2023.0.0</code> </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The name of the environment variable for mkl’s root directory set by its module (<code>MKLROOT</code>, set when we <code>module load intel-oneapi-mkl/2023.0.0-intel</code>) is not necessarily going to match the corresponding root directory variable in a given makefile. It did in this instance, but that’s not guaranteed. The VASP makefile.include could have just as easily used <code>MKL_ROOT</code>, instead of <code>MKLROOT</code>. This is one reason why it’s safer to use <code>module show</code> to find the path of the root directory, then copy this path into the makefile, rather than rely on environment variables.  </p>
</div>
<p>To do step 2, we should first look at the contents of <code>$MKLROOT</code>. To show the contents of the MKL directory, type</p>
<p><code>ls /sfs/nopt/nrel/apps/libraries/01-23/spack/opt/spack/linux-rhel8-icelake/intel-2021.6.0/intel-oneapi-mkl-2023.0.0-gnkrgwyxskxitvptyoubqaxlhh2v2re2/mkl/2023.0.0</code></p>
<p>We should obtain the following output:</p>
<p><code>benchmarks  bin  env  examples  include  interfaces  lib  licensing  modulefiles  tools</code></p>
<p>If we look closely at the makefile, we see beneath the <code>MKLROOT</code> line the following:
<div class="highlight"><pre><span></span><code>MKLROOT    ?= /sfs/nopt/nrel/apps/libraries/01-23/spack/opt/spack/linux-rhel8-icelake/intel-2021.6.0/intel-oneapi-mkl-2023.0.0-gnkrgwyxskxitvptyoubqaxlhh2v2re2/mkl/2023.0.0
LLIBS      += -L$(MKLROOT)/lib/intel64 -lmkl_scalapack_lp64 -lmkl_blacs_intelmpi_lp64
</code></pre></div></p>
<p>the <code>LLIBS</code> line is telling make which libraries in particular to pick out. </p>
<p>So, we want to go into the lib directory, and then the intel64 directory (since LLIBS is pointing to <code>$MKLROOT/lib/intel64</code>). Let's see what's inside with the <code>ls</code> command:</p>
<p><code>ls  /sfs/nopt/nrel/apps/libraries/01-23/spack/opt/spack/linux-rhel8-icelake/intel-2021.6.0/intel-oneapi-mkl-2023.0.0-gnkrgwyxskxitvptyoubqaxlhh2v2re2/mkl/2023.0.0/lib/intel64</code></p>
<p>There's a lot of stuff in this directory! VASP helps us by telling us we need the <code>mkl_scalapack_lp64</code> and <code>mkl_blacs_openmpi_lp64</code> builds specifically. You won't always be told exactly which libraries, and figuring this out, if the information is not provided to you in the package documentation, can require some tinkering.</p>
<p>In general, the <code>.a</code> extension is for static linking, and the <code>.so</code> extension is for dynamic linking. For MKL in particular, the part <code>ilp64</code> vs <code>lp64</code> refer to two different interfaces to the MKL library. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Notice that, inside <code>$MKLROOT/lib/intel64</code>, the  filenames all start with <code>libmkl</code>, but in our makefile, we reference <code>lmkl_scalapack_lp64</code>. That's not a file in <code>$MKLROOT/lib/intel64</code>, but <code>libmkl_scalapack_lp64.so</code> is. The notation is that "big L" references the directories that the libraries are in, and the "little l" references the particular libraries. For example:
<pre> LLIBS += <b>-L</b>$(MKLROOT)/lib/intel64 </pre>
<pre> <b>-l</b>mkl_scalapack_lp64</pre> This is just a convention, but is important to get right because your compile will fail otherwise.</p>
</div>
<p>Now that we have the correct <code>MKLROOT</code> set in the makefile.include, and we have an idea about how it's referencing the libraries within, we can move on to linking the HDF5 library.</p>
<h3 id="modifying-the-makefile-for-hdf5">Modifying the Makefile for HDF5<a class="headerlink" href="#modifying-the-makefile-for-hdf5" title="Permanent link">#</a></h3>
<p>Because HDF5 is an optional library, we could compile the code now if we wanted to. However, for the sake of practice, let’s uncomment the block in the makefile.include file related to HDF5 and repeat the exercise of linking a library: </p>
<div class="highlight"><pre><span></span><code># HDF5-support (optional but strongly recommended) 
CPP_OPTIONS+= -DVASP_HDF5 
HDF5_ROOT  ?= /path/to/your/hdf5/installation 
LLIBS      += -L$(HDF5_ROOT)/lib -lhdf5_fortran 
INCS       += -I$(HDF5_ROOT)/include 
</code></pre></div>
<p>Our job, again, is to give the makefile the correct directions to our library. In this case, it’s HDF5. Let’s see which HDF5 modules are available: </p>
<p><code>module avail hdf5</code> </p>
<p>Returns </p>
<p><code>hdf5/1.12.2-intel-oneapi-mpi-intel hdf5/1.12.2-openmpi-gcc</code> </p>
<p>So, we see that HDF5 has been built with the intel-oneapi-mpi toolchain, and also with the GCC/openmpi toolchain. Since we’re building vasp using the intel-oneapi toolchain, we need to load the corresponding module: </p>
<p><code>module load hdf5/1.12.2-intel-oneapi-mpi-intel</code> </p>
<p>Again, we must locate the root directory: </p>
<p><code>module show hdf5/1.12.2-intel-oneapi-mpi-intel</code> </p>
<p>We see the line for setting the HDF5 root directory environment variable: </p>
<p><code>setenv      HDF5_ROOT_DIR /sfs/nopt/nrel/apps/libraries/01-23/spack/opt/spack/linux-rhel8-icelake/intel-2021.6.0/hdf5-1.12.2-dzgeixsm2cd3mupx4ti77ozeh7rh6zdo</code> </p>
<p>Like before, we copy this path into our makefile.include: </p>
<div class="highlight"><pre><span></span><code># HDF5-support (optional but strongly recommended) 
CPP_OPTIONS+= -DVASP_HDF5 
HDF5_ROOT  ?= /sfs/nopt/nrel/apps/libraries/01-23/spack/opt/spack/linux-rhel8-icelake/intel-2021.6.0/hdf5-1.12.2-dzgeixsm2cd3mupx4ti77ozeh7rh6zdo 
LLIBS      += -L$(HDF5_ROOT)/lib -lhdf5_fortran 
INCS       += -I$(HDF5_ROOT)/include 
</code></pre></div>
<p>We’re ready to compile! In the case of VASP, the compile command is <code>make DEPS=1 std</code> but in general, the command may be <code>make all</code> or similar (consult the documentation of the code you’re trying to build). </p>
<p>If you’re working with a code that has a testsuite, now is a good time to run the testsuite to make sure that your compile was successful. </p>
<h2 id="summary-of-steps">Summary of Steps<a class="headerlink" href="#summary-of-steps" title="Permanent link">#</a></h2>
<ol>
<li>Download the source code of the package you’re trying to build. This will generally be found on the website of the package. </li>
<li>Consult the documentation of the package to find out what scientific libraries are needed, and if the package developers provide guidance on what toolchains/libraries are best </li>
<li>Determine the availability of the needed scientific libraries.  <ol>
<li>Can a “library-of-libraries” like MKL or LibSci be used? </li>
<li>Does NREL support the library as a module?  <ol>
<li>If so, determine the toolchain it was built with (usually given in the name of the module). If the toolchain is not clear from the name of the module, try the <code>ldd</code> command (e.g., <code>ldd path/to/executable/executable</code>), which will show you the dynamically linked libraries of the executable.</li>
</ol>
</li>
</ol>
</li>
<li>Prepare your environment <ol>
<li><code>module load</code> the necessary modules to prepare your environment. (See  <a href="#environment-preparation">environment preparation</a> step of VASP example) </li>
</ol>
</li>
<li>Prepare your makefile <ol>
<li>Make sure that the compilers and (optional) MPI used in the makefile match what is used to build your scientific libraries as best as possible </li>
<li>Make sure that the paths to the scientific libraries in the makefile match the path given by the <code>module show</code> command </li>
<li>Make sure the proper “little L” libraries are referenced in the makefile </li>
</ol>
</li>
<li>Compile!</li>
</ol>
<h2 id="questions">Questions?<a class="headerlink" href="#questions" title="Permanent link">#</a></h2>
<p>If you’re still stuck and unable to successfully link the scientific libraries you need, get in contact with <a href="mailto:hpc-help@nrel.gov">HPC help</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.indexes", "navigation.path", "toc.follow"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e1c3ead8.min.js"></script>
      
    
  </body>
</html>